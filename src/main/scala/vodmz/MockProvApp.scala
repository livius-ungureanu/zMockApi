package vodmz
import scala.util.Try
import zio.*
import zio.http.*
import zio.http.model.{Method, Status}

object MockProvApp extends ZIOAppDefault {


  private val app = Http.collectZIO[Request] {
    case Method.POST -> !! / "auth"/"realms"/"Openet"/"protocol"/"openid-connect"/"token" =>
      ZIO.succeed(Response.text(keyCloakResp))

    case Method.POST -> !! / "cpg"/"v1"/"provisioning"/"v2"/"subscribers" =>
      ZIO.succeed(Response.text(createSubsResp).setStatus(Status.Created))
  }

  val run =
    Server
      .serve(app)
      .provide(Server.defaultWithPort(8071))

  private val keyCloakResp = """
      |{"access_token":"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIxR1cxT2N6NWRfVUliYkFjaTZiRUNZQVZXOWE5ZzYxenRTWEx1Z193SFdjIn0.eyJleHAiOjE2ODMxMzU1NjEsImlhdCI6MTY4MzEzNTI2MSwianRpIjoiYzk3OTU4NDYtMTdiYS00ZThmLTg3YTQtYjNiZGE0OTZhZDNlIiwiaXNzIjoiaHR0cDovLzEwLjE1LjM1Ljc0OjMwMDk0L2F1dGgvcmVhbG1zL09wZW5ldCIsImF1ZCI6WyJvYy1ndWkiLCJhcHAtcmVnaXN0ZXItZGVwbG95ZXIiLCJhcHAtc2VsZWN0b3IiLCJhY2NvdW50Il0sInN1YiI6IjMxZWNmZDgxLTYxZWItNDY4Yi05ZmJiLTEzZGVjZjhiNjNkNiIsInR5cCI6IkJlYXJlciIsImF6cCI6Im9wZW5ldC1jbGkiLCJzZXNzaW9uX3N0YXRlIjoiNzk2ZGQzZDAtOTg2ZC00NTFhLWIyZDQtYWJlY2JkMTRmZGJhIiwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtb3BlbmV0Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7Im9jLWd1aSI6eyJyb2xlcyI6WyJPRkZFUl9HUk9VUFNfRCIsIkFVRElUIiwiUkRfQUJfQ0xBU1NJRklDQVRJT05TX0MiLCJSRF9BQl9DTEFTU0lGSUNBVElPTlNfRCIsIlJEX0FQTlNfRCIsIk9GRkVSX0dST1VQU19DIiwiUkRfQVBOU19DIiwiQ09ORElUSU9OU19DIiwiQ09ORElUSU9OU19EIiwiUkRfQUJfQ0xBU1NJRklDQVRJT05TX1IiLCJSRF9BQl9DTEFTU0lGSUNBVElPTlNfVSIsIlJEX0FQTlNfVSIsIlJEX0FQTlNfUiIsIlJEX0NVU1RPTV9GSUVMRFNfQyIsIlJEX0NVU1RPTV9GSUVMRFNfRCIsIlBSSUNFX1BMQU5TX1IiLCJSRF9OT1RJRklDQVRJT05fVEVNUExBVEVTX0QiLCJSRF9OT1RJRklDQVRJT05fVEVNUExBVEVTX0MiLCJQUklDRV9QTEFOU19VIiwiUkRfUE9MSUNZX0NPVU5URVJTX1UiLCJSRF9UT0RfUkVGU19VIiwiUkRfWk9ORVNfUiIsIlJEX1NFUlZJQ0VfREVGSU5JVElPTlNfVSIsIlJEX1BSSUNFX1BMQU5fVFlQRVNfQyIsIlJEX1BPTElDWV9DT1VOVEVSU19SIiwiUkRfU0VSVklDRV9ERUZJTklUSU9OU19SIiwiUkRfUFJJQ0VfUExBTl9UWVBFU19EIiwiUkRfQ1VTVE9NX0ZJTFRFUlNfRCIsIlJEX0NVU1RPTV9GSUxURVJTX0MiLCJUSFJFU0hPTERTX1UiLCJPRkZFUlNfRCIsIk9GRkVSU19DIiwiUkRfVE9EX1JFRlNfUiIsIlRIUkVTSE9MRFNfUiIsIlJEX1BSSUNFX1BMQU5fVFlQRVNfVSIsIlJEX1RPRF9SRUZTX0QiLCJSRF9QUklDRV9VTklUU19VIiwiUkRfTk9USUZJQ0FUSU9OX1RFTVBMQVRFU19SIiwiUkRfUFJJQ0VfUExBTl9UWVBFU19SIiwiUkRfU0VSVklDRV9ERUZJTklUSU9OU19EIiwiUkRfU0VSVklDRV9ERUZJTklUSU9OU19DIiwiVEhSRVNIT0xEU19DIiwiVEhSRVNIT0xEU19EIiwiUkRfTk9USUZJQ0FUSU9OX1RFTVBMQVRFU19VIiwiUkRfWk9ORVNfVSIsIlJEX1RPRF9SRUZTX0MiLCJSRF9USU1FX0JBTkRTX0MiLCJSRF9USU1FX0JBTkRTX0QiLCJSRVBMSUNBVElPTl9JTVBPUlQiLCJSRF9USUVSU19SIiwiUkVQTElDQVRJT05fRVhQT1JUIiwiUkRfVElFUlNfVSIsIlJEX0NVU1RPTV9GSUVMRFNfUiIsIlJEX1pPTkVTX0MiLCJSRF9QT0xJQ1lfQ09VTlRFUlNfRCIsIlJEX1pPTkVTX0QiLCJPRkZFUl9HUk9VUFNfVSIsIlJEX05FVFdPUktfU0xJQ0lOR19SIiwiT0ZGRVJfR1JPVVBTX1IiLCJSRF9ORVRXT1JLX1NMSUNJTkdfVSIsIlJEX0NVU1RPTV9GSUVMRFNfVSIsIlJEX1BPTElDWV9DT1VOVEVSU19DIiwiT0ZGRVJTX1UiLCJSRF9USUVSU19EIiwiUkRfVElFUlNfQyIsIk9GRkVSU19SIiwiUkRfTkVUV09SS19TTElDSU5HX0MiLCJSRF9ORVRXT1JLX1NMSUNJTkdfRCIsIlJEX1JBVF9UWVBFU19SIiwiUkRfUkFUX1RZUEVTX1UiLCJSRF9USU1FX0JBTkRTX1IiLCJSRF9USU1FX0JBTkRTX1UiLCJSRF9ST1VORElOR1NfQyIsIlJEX1JPVU5ESU5HU19EIiwiU0NIRURVTEVTX1UiLCJSRF9BRERPTlNfQyIsIlJEX1BSSUNFX1VOSVRTX0QiLCJSRF9DQVRFR09SSUVTX1UiLCJSRF9QUklDRV9VTklUU19DIiwiUkRfQURET05TX0QiLCJSRF9DQVRFR09SSUVTX1IiLCJSRF9DVVNUT01fRklMVEVSU19VIiwiUkRfQ0FSUklFUlNfRCIsIlJEX1BSSUNFX1VOSVRTX1IiLCJSRF9DQVJSSUVSU19DIiwiUkRfQ0FURUdPUklFU19EIiwiU0NIRURVTEVTX0MiLCJSRF9BRERPTlNfVSIsIlJEX0NBVEVHT1JJRVNfQyIsIlNDSEVEVUxFU19EIiwiUkRfUkFUX1RZUEVTX0MiLCJSRF9SQVRfVFlQRVNfRCIsIlJEX0FERE9OU19SIiwiUkRfQ0FSUklFUlNfUiIsIlJEX0NVU1RPTV9GSUxURVJTX1IiLCJTQ0hFRFVMRVNfUiIsIlJEX0NBUlJJRVJTX1UiLCJSRF9RT1NfVSIsIlJEX0RFVklDRV9HUk9VUFNfQyIsIlJEX0RFVklDRV9HUk9VUFNfRCIsIlJEX1FPU19SIiwiUkRfQkFMQU5DRVNfQyIsIlJEX0JBTEFOQ0VfU1RBVEVTX1UiLCJSRF9CQUxBTkNFU19EIiwiUkRfQkFMQU5DRV9TVEFURVNfUiIsIlJEX1FPU19EIiwiUkRfUU9TX0MiLCJSRF9CQUxBTkNFU19VIiwiUkRfQkFMQU5DRVNfUiIsIlJFUExJQ0FUSU9OX0RFUExPWSIsIlBSSUNFX1BMQU5TX0QiLCJQUklDRV9QTEFOU19DIiwiUkRfUk9VTkRJTkdTX1UiLCJSRF9NT05JVE9SSU5HX0tFWVNfRCIsIlJEX01PTklUT1JJTkdfS0VZU19DIiwiUkRfQ0FMTF9UWVBFU19DIiwiRU5USVRMRU1FTlRTX0MiLCJFTlRJVExFTUVOVFNfRCIsIlJEX0NBTExfVFlQRVNfRCIsIlJEX1JPVU5ESU5HU19SIiwiUkRfREVWSUNFX0dST1VQU19VIiwiUkRfTU9OSVRPUklOR19LRVlTX1IiLCJSRF9ERVZJQ0VfR1JPVVBTX1IiLCJSRF9NT05JVE9SSU5HX0tFWVNfVSIsIlJEX0JBTEFOQ0VfU1RBVEVTX0MiLCJSRF9DQUxMX1RZUEVTX1IiLCJFTlRJVExFTUVOVFNfUiIsIlJEX0JBTEFOQ0VfU1RBVEVTX0QiLCJSRF9DQUxMX1RZUEVTX1UiLCJDT05ESVRJT05TX1IiLCJFTlRJVExFTUVOVFNfVSIsIkNPTkRJVElPTlNfVSJdfSwiYXBwLXJlZ2lzdGVyLWRlcGxveWVyIjp7InJvbGVzIjpbIlRSR1JfREVQTE9ZIl19LCJhcHAtc2VsZWN0b3IiOnsicm9sZXMiOlsiT0ZGRVJfQ0FUQUxPRyJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJlbWFpbCBwcm9maWxlIiwic2lkIjoiNzk2ZGQzZDAtOTg2ZC00NTFhLWIyZDQtYWJlY2JkMTRmZGJhIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvY19hZG1pbiJ9.IL0nK7ttPBCHgGaWXL-jOTKtqQ1NasqOCILSQKrSjJhKrAM-t0ElGWXVu4R0ZPz3fRzJh4uJE5Zk3ZTrJLWIho9M-xRtqZ0eseedTJX9xR3Cs4Ui657TNrNJL4mE8nKfP-eszSWyyVC0sH_mBLDGXNrCzvRjcUKL21iU4Ap0GJ4UNAqkej6BKZzniRXZTB3ySVQncW96j8zEESvLTZjaCbnQHh67_Mhax9nDixJqPOOkRrQ6OMr-cnBXNW0CGs7GLbBcZUYymr9qaoFMOk6ItMe0YXY0ajNLiD3NGqNECViSqL-ruyETyKxX4UAXbeog39iH9jbPhfSRRbv86dVV3A","expires_in":300,"refresh_expires_in":1800,"refresh_token":"eyJhbGciOiJIUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJkYmI5MTdlNS0zNDQ3LTRmMWUtOTZlMi0wZWZlNDkyYTE3YWYifQ.eyJleHAiOjE2ODMxMzcwNjEsImlhdCI6MTY4MzEzNTI2MSwianRpIjoiYzMxNjIyZTUtMDJkYS00ZGM3LTgzMDEtMTlhZDI5Njg3NzUyIiwiaXNzIjoiaHR0cDovLzEwLjE1LjM1Ljc0OjMwMDk0L2F1dGgvcmVhbG1zL09wZW5ldCIsImF1ZCI6Imh0dHA6Ly8xMC4xNS4zNS43NDozMDA5NC9hdXRoL3JlYWxtcy9PcGVuZXQiLCJzdWIiOiIzMWVjZmQ4MS02MWViLTQ2OGItOWZiYi0xM2RlY2Y4YjYzZDYiLCJ0eXAiOiJSZWZyZXNoIiwiYXpwIjoib3BlbmV0LWNsaSIsInNlc3Npb25fc3RhdGUiOiI3OTZkZDNkMC05ODZkLTQ1MWEtYjJkNC1hYmVjYmQxNGZkYmEiLCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJzaWQiOiI3OTZkZDNkMC05ODZkLTQ1MWEtYjJkNC1hYmVjYmQxNGZkYmEifQ.wJ-YQQlDPRSvjpHJC0CB7WDO9JvyYmidQ4HetMoHLi0",
      | "token_type":"Bearer",
      | "not-before-policy":0,
      | "session_state":"796dd3d0-986d-451a-b2d4-abecbd14fdba",
      | "scope":"email profile"}
      |""".stripMargin

    private val createSubsResp = """
        | {"responseStatus":{"status":"SUCCESS"}}
        |""".stripMargin
}
